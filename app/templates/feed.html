{% extends "account/base.html" %}
{% load static %}

{% block title %}Seu Feed - EsporteFY{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/feed.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
{% endblock %}

{% block body_class %}dark-theme{% endblock %} {# Adiciona uma classe ao body para o tema escuro #}

{% block content %}
<div class="container my-4">

    <div class="welcome-container">
        {% now "H" as hora_atual %}
        <h1 class="welcome-header">
            {% if hora_atual|add:"0" < 12 %}Bom dia
            {% elif hora_atual|add:"0" < 18 %}Boa tarde
            {% else %}Boa noite
            {% endif %}
            , {{ user.username|capfirst }}!
        </h1>
    </div>

    <div class="row gx-4">
        <div class="col-lg-3">
            <h2 class="section-title"><i class="bi bi-people-fill"></i>Mural Social</h2>
            </div>

        <div class="col-lg-6">
            <div class="card action-card mb-4">
                <div class="card-header">Acesso Rápido</div>
                <div class="card-body d-flex flex-wrap gap-2">
                    <a href="{% url 'partidas:criar_partida' %}" class="btn btn-primary flex-grow-1">
                        <i class="bi bi-plus-circle-fill me-2"></i>Criar Partida
                    </a>
                    <a href="{% url 'partidas:minhas_partidas' %}" class="btn btn-outline-secondary flex-grow-1">
                        <i class="bi bi-calendar-check me-2"></i>Ver Minhas Partidas
                    </a>
                </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="section-title"><i class="bi bi-dribbble"></i>Partidas Abertas</h2>
                <div class="dropdown">
                    <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                        Bairro: <strong>{{ bairro_atual_nome }}</strong>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="?bairro=todos">Todos os Bairros</a></li>
                        {% for valor, nome in bairros_disponiveis %}
                            <li><a class="dropdown-item" href="?bairro={{ valor }}">{{ nome }}</a></li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            
            {% for partida in partidas %}
            <div class="card match-card mb-3">
                <div class="card-body">
                    </div>
            </div>
            {% empty %}
            <div class="card no-match-card">
                <div class="card-body">
                    <i class="bi bi-emoji-frown me-2"></i>
                    Nenhuma partida encontrada. Que tal <a href="{% url 'partidas:criar_partida' %}">criar uma</a>?
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="col-lg-3 news-sidebar">
            <h2 class="section-title"><i class="bi bi-newspaper"></i>Notícias</h2>
            {% for noticia in noticias %}
            <a href="{{ noticia.url }}" target="_blank">
                <div class="card news-card mb-3">
                    {% if noticia.urlToImage %}
                        <img src="{{ noticia.urlToImage }}" class="card-img-top" alt="{{ noticia.title }}">
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title">{{ noticia.title|truncatechars:60 }}</h5>
                        <small class="news-source">{{ noticia.source.name }}</small>
                    </div>
                </div>
            </a>
            {% empty %}
            <div class="card"><div class="card-body text-muted">Não foi possível carregar as notícias.</div></div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}